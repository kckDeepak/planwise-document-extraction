{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "description": "Comprehensive schema to extract all possible data from a St. James's Place retirement illustration, covering client details, investments, projections, charges, assumptions, and regulatory metadata. Unified Retirement Account Illustration.",
  "properties": {
    "document_metadata": {
      "type": "object",
      "description": "High level document identifiers and context",
      "properties": {
        "document_type": {
          "type": "string",
          "description": "Type of the document (e.g.,Illustration)"
        },
        "provider_name": {
          "type": "string",
          "description": "Name of the provider"
        },
        "illustration_date": {
          "type": "string",
          "description": "Date the illustration was generated (e.g., '14 November 2025')"
        },
        "account_number": {
          "type": "string",
          "description": "Account or policy number if present"
        },
        "currency": {
          "type": "string",
          "description": "Currency used in the illustration",
          "default": "GBP"
        },
        "sjp_partner_name": {
          "type": "string",
          "description": "Name of the SJP Partner/Advisor (e.g., 'Shaf Hussain')"
        },
        "reference_number": {
          "type": "string",
          "description": "Unique reference number for the illustration"
        }
      }
    },
    "client_details": {
      "type": "object",
      "description": "Primary client information",
      "properties": {
        "title": {
          "type": "string",
          "description": "Client's title"
        },
        "client_name": {
          "type": "string",
          "description": "Full name of the client (e.g., 'Victor Tray')"
        },
        "date_of_birth": {
          "type": "string",
          "description": "Client's date of birth (e.g., '23 June 1997')"
        },
        "gender": {
          "type": "string",
          "description": "Client's gender"
        },
        "anticipated_retirement_age": {
          "type": "string",
          "description": "Anticipated retirement age in years (e.g., 67)"
        },
        "current_age": {
          "type": "string",
          "description": "Client's current age"
        },
        "tax_rate_percentage": {
          "type": "string",
          "description": "Client's marginal tax rate (e.g., '45%', '20%')"
        },
        "tax_residency": {
          "type": "string",
          "description": "Client's tax residency"
        },
        "national_insurance_number": {
          "type": "string",
          "description": "Client's NI number"
        },
        "projection_start_date": {
          "type": "string",
          "description": "Date from which projection starts (e.g., '14 November 2025')"
        },
        "inflation_assumption": {
          "type": "string",
          "description": "Inflation rate used in projections, typically found in notes section (e.g., '2.00%')",
          "default": "2.00%"
        }
      }
    },
    "investment_summary": {
      "type": "object",
      "description": "Overall investment positioning",
      "properties": {
        "investment_strategy_name": {
          "type": "string",
          "description": "Name of the pension scheme/strategy from the notes (e.g., 'St. James's Place Personal Retirement Plan')"
        },
        "fund_risk_profile": {
          "type": "string",
          "description": "Fund chosen for investment (e.g., 'Polaris 4')"
        },
        "total_new_investments_amount": {
          "type": "string",
          "description": "Total amount of new investment in GBP (e.g., '£24,303.86')"
        },
        "total_existing_investments_amount": {
          "type": "string",
          "description": "Total amount of existing investments"
        },
        "total_portfolio_value": {
          "type": "string",
          "description": "Total portfolio value"
        }
      }
    },
    "new_investments": {
      "type": "array",
      "description": "All incoming transfers or new contributions",
      "items": {
        "type": "object",
        "properties": {
          "source_provider": {
            "type": "string",
            "description": "Description of the transfer source (e.g., 'Transfer from Legal & General')"
          },
          "plan_type": {
            "type": "string",
            "description": "Type of investment (e.g., 'Uncrystallised', 'Crystallised')"
          },
          "transfer_value": {
            "type": "string",
            "description": "Amount being transferred in GBP (e.g., '£24,303.86')"
          },
          "crystallised_status": {
            "type": "string",
            "description": "Status of crystallisation"
          }
        }
      }
    },
    "existing_investments": {
      "type": "array",
      "description": "Pre existing holdings and their characteristics",
      "items": {
        "type": "object",
        "properties": {
          "investment_name": {
            "type": "string",
            "description": "Name of existing investment"
          },
          "current_value": {
            "type": "string",
            "description": "Current value of existing investment"
          },
          "ongoing_charge_percentage": {
            "type": "string",
            "description": "Ongoing charge percentage"
          },
          "early_withdrawal_charge_details": {
            "type": "string",
            "description": "EWC details"
          }
        }
      }
    },
    "charges": {
      "type": "object",
      "description": "All explicit and implicit charges",
      "properties": {
        "initial_advice_charge": {
          "type": "object",
          "description": "Initial Advice Charge (IAC) details",
          "properties": {
            "percentage": {
              "type": "string",
              "description": "Percentage charge (e.g., '3.00%')"
            },
            "amount": {
              "type": "string",
              "description": "Monetary amount in GBP (e.g., '£729.12')"
            }
          }
        },
        "ongoing_charges": {
          "type": "object",
          "description": "Ongoing charges breakdown",
          "properties": {
            "advice_percentage": {
              "type": "string",
              "description": "Ongoing Advice Charge percentage (e.g., '0.80%')"
            },
            "product_percentage": {
              "type": "string",
              "description": "Product/wrapper charge percentage (e.g., '0.35%')"
            },
            "fund_percentage": {
              "type": "string",
              "description": "Fund charge percentage (e.g., '0.55%')"
            },
            "total_percentage": {
              "type": "string",
              "description": "Total percentage charge (e.g., '1.70%')"
            },
            "estimated_year_one_amount": {
              "type": "string",
              "description": "Total monetary amount in GBP per year (e.g., '£413.17 a year')"
            }
          }
        }
      }
    },
    "charges_detail_new_investments": {
      "type": "array",
      "description": "Detailed charges breakdown per investment source. Preserved from original schema.",
      "items": {
        "type": "object",
        "properties": {
          "source_description": {
            "type": "string",
            "description": "Description of the investment source with amount"
          },
          "initial_advice_charge": {
            "type": "object",
            "properties": {
              "percentage": {
                "type": "string"
              },
              "amount": {
                "type": "string"
              }
            }
          },
          "ongoing_advice_charge": {
            "type": "object",
            "properties": {
              "percentage": {
                "type": "string"
              },
              "amount": {
                "type": "string"
              }
            }
          },
          "ongoing_product_charge": {
            "type": "object",
            "properties": {
              "percentage": {
                "type": "string"
              },
              "amount": {
                "type": "string"
              }
            }
          },
          "ongoing_fund_charge": {
            "type": "object",
            "properties": {
              "percentage": {
                "type": "string"
              },
              "amount": {
                "type": "string"
              }
            }
          },
          "total_ongoing_charge": {
            "type": "object",
            "properties": {
              "percentage": {
                "type": "string"
              },
              "amount": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "tiered_product_charges": {
      "type": "array",
      "description": "Table 5: Tiered Product/Wrapper Annual Charges based on total investment value. Preserved from original schema.",
      "items": {
        "type": "object",
        "properties": {
          "tier_band": {
            "type": "string",
            "description": "Value band for the tier"
          },
          "charge_percentage": {
            "type": "string",
            "description": "Ongoing Product Charge percentage for this tier"
          }
        }
      }
    },
    "growth_assumptions": {
      "type": "object",
      "description": "Regulatory growth assumptions used in projections",
      "properties": {
        "lower_rate_before_charges": {
          "type": "string",
          "description": "Lower assumed growth rate before charges"
        },
        "intermediate_rate_before_charges": {
          "type": "string",
          "description": "Intermediate assumed growth rate before charges"
        },
        "higher_rate_before_charges": {
          "type": "string",
          "description": "Higher assumed growth rate before charges"
        },
        "rates_after_charges": {
          "type": "object",
          "properties": {
            "lower": {
              "type": "string",
              "description": "Lower assumed growth rate after charges"
            },
            "intermediate": {
              "type": "string",
              "description": "Intermediate assumed growth rate after charges"
            },
            "higher": {
              "type": "string",
              "description": "Higher assumed growth rate after charges"
            }
          }
        }
      }
    },
    "projections_at_retirement": {
      "type": "array",
      "description": "Outcome projections under multiple growth scenarios",
      "items": {
        "type": "object",
        "properties": {
          "scenario_name": {
            "type": "string",
            "description": "Scenario name (e.g. 'Lower Rate', 'Intermediate Rate', 'Higher Rate')"
          },
          "projected_fund_value": {
            "type": "string",
            "description": "Projected fund value at retirement in GBP"
          },
          "tax_free_cash_amount": {
            "type": "string",
            "description": "Tax-free cash sum at retirement in GBP"
          },
          "annual_taxable_income": {
            "type": "string",
            "description": "Annual taxable income at retirement in GBP"
          }
        }
      }
    },
    "year_by_year_projection": {
      "type": "array",
      "description": "Detailed projection table showing charge impact over time",
      "items": {
        "type": "object",
        "properties": {
          "year_or_age": {
            "type": "string",
            "description": "At End of Year number or retirement age (e.g., '1', '5', '10', 'Age 67')"
          },
          "total_paid_in": {
            "type": "string",
            "description": "Total Paid in to Date in GBP (e.g., '£24,304')"
          },
          "value_before_charges": {
            "type": "string",
            "description": "Projected Transfer Value if there were No Charges in GBP (e.g., '£25,000')"
          },
          "value_after_product_fund_charges": {
            "type": "string",
            "description": "Projected Transfer Value if all charges except advice charges are taken"
          },
          "value_after_all_charges": {
            "type": "string",
            "description": "Projected Transfer Value after All Charges are Taken in GBP (e.g., '£23,800')"
          }
        }
      }
    },
    "regulatory_notes": {
      "type": "object",
      "description": "Disclaimers, assumptions, and compliance text",
      "properties": {
        "risk_warnings": {
          "type": "string",
          "description": "Risk warnings text"
        },
        "projection_basis": {
          "type": "string",
          "description": "Basis of projection text"
        },
        "capital_at_risk_statement": {
          "type": "string",
          "description": "Capital at risk statement"
        }
      }
    },
    "fund_allocations": {
      "type": "array",
      "description": "Detailed split of investments by fund. Preserved from original.",
      "items": {
        "type": "object",
        "properties": {
          "fund_name": {
            "type": "string",
            "description": "Name of the fund (e.g., 'Polaris 4', 'Balanced Portfolio')"
          },
          "allocation_percentage": {
            "type": "string",
            "description": "Percentage of investment allocated to this fund (e.g., '100.0%', '50%')"
          },
          "fund_charge": {
            "type": "string",
            "description": "Annual fund charge percentage and/or amount (e.g., '0.55%', '£133.67')"
          },
          "growth_rates": {
            "type": "object",
            "description": "Fund growth rate assumptions used in projections",
            "properties": {
              "lower": {
                "type": "string",
                "description": "Lower assumed growth rate (e.g., '-0.1%')"
              },
              "intermediate": {
                "type": "string",
                "description": "Intermediate assumed growth rate (e.g., '2.9%')"
              },
              "higher": {
                "type": "string",
                "description": "Higher assumed growth rate (e.g., '5.9%')"
              }
            }
          }
        }
      }
    },
    "reduction_in_yield": {
      "type": "object",
      "description": "Table 7: How the charges can reduce the growth. Preserved from original, some fields may duplicate growth_assumptions.",
      "properties": {
        "growth_before_charges": {
          "type": "string"
        },
        "growth_excl_advice_charges": {
          "type": "string"
        },
        "growth_after_all_charges": {
          "type": "string"
        },
        "reduction_for_product_charges": {
          "type": "string"
        },
        "total_reduction_in_yield": {
          "type": "string"
        }
      }
    }
  },
  "required": [
    "document_metadata",
    "client_details",
    "investment_summary",
    "charges"
  ]
}